import "interface.cui";
policy count_social (
    act (RPCRequest request)
    using (Counter counter)
    using (Timer timer)
    context ('frontendservice.*productcatalogservice')
) {
    [Ingress]
    Increment(counter);
    if (IsTimeSince(timer, 60)) {
        if (IsGreaterThan(counter, 1000)) {
            Deny(request)
        }
        Reset(counter)
    }
}